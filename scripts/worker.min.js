const worker_function=()=>{let e;const t=new function(){let e=0;this.get=(()=>e),this.add=(()=>++e)};self.addEventListener("message",r=>{const s=r.data;switch(s.type){case"start":importScripts(s.url),e=a(s.orientation,s.format);break;case"image":for(;e.getNumberOfPages()<s.page+1;)e.addPage();((a,r,s,n,g,i,o=!1)=>{const c=()=>{if(o&&URL.revokeObjectURL(r),t.add()>=i)try{self.postMessage({data:URL.createObjectURL(e.toBlob()),type:"finish"})}catch(e){self.postMessage({type:"error"})}};if(e.setPage(a),"auto"==g)e.drawImage(r).then(()=>{c()});else{const t=e.getPageWidth(a)/s>e.getPageHeight(a)/n?e.getPageHeight(a)/n:e.getPageWidth(a)/s,g=(e.getPageWidth(a)-s*t)/2,i=(e.getPageHeight(a)-n*t)/2;e.drawImage(r,g,i,e.getPageWidth(a)-2*g,e.getPageHeight(a)-2*i).then(()=>{c()}).catch(()=>{c()})}})(s.page,s.src,s.width,s.height,s.format,s.max,s.revoke)}});const a=(e,t)=>{return new PDFBuilder({orientation:e,format:t})}},compressor=new Compressor,addImage=(e,t,a,r,s,n,g,i,o,c,m=!1)=>{const d=()=>{if(m&&URL.revokeObjectURL(a),i.add()>=o)try{const t=URL.createObjectURL(e.toBlob());saveAs(t,g),URL.revokeObjectURL(t),c.remove()}catch(e){c.remove(),alert((()=>"이미지 PDF 변환"==document.title?"알수없는 오류!":"イメージを PDF に変換"==document.title?"不明なエラーです。":"Unknown error!")())}};if(e.setPage(t),"auto"==n)e.drawImage(a).then(()=>{d()}).catch(()=>{d()});else{const n=e.getPageWidth(t)/r>e.getPageHeight(t)/s?e.getPageHeight(t)/s:e.getPageWidth(t)/r,g=(e.getPageWidth(t)-r*n)/2,i=(e.getPageHeight(t)-s*n)/2;e.drawImage(a,g,i,e.getPageWidth(t)-g,e.getPageHeight(t)-i).then(()=>{d()})}},PDFCreate=(e,t)=>{return new PDFBuilder({orientation:e,format:t})},imageCompress=(e,t)=>new Promise(a=>{compressor.start(e,{quality:t,success(e){a(URL.createObjectURL(e))}})}),getImageSrc=(e,t,a)=>new Promise(r=>{0==t?r(e):imageCompress(e,a).then(e=>{r(e)})}),imageListPDF=(e,t,a,r,s)=>new Promise(()=>{const n=PDFCreate(t,a),g=`${r[0].getElementsByClassName("imageName")[0].innerText.substring(r[0].getElementsByClassName("imageName")[0].innerText.lastIndexOf("."),0)}.pdf`,i=(()=>{switch(parseInt(s)){case 1:return.8;case 2:return.65;case 3:return.5;default:return 1}})(),o=new function(){let e=0;this.get=(()=>e),this.add=(()=>++e)};compressTime=0;for(let t=0;t<r.length;t++){for(;n.getNumberOfPages()<t+1;)n.addPage();const c=r[t].getElementsByTagName("img")[0];""!=c.src?getImageSrc(c.src,s,i).then(i=>{addImage(n,t,i,c.naturalWidth,c.naturalHeight,a,g,o,r.length,e,0!=s)}):c.onload=(()=>{getImageSrc(c.src,s,i).then(i=>{addImage(n,t,i,c.naturalWidth,c.naturalHeight,a,g,o,r.length,e,0!=s)})})}}),imageListPDFByThread=(e,t,a,r,s)=>new Promise(()=>{const n=URL.createObjectURL(new Blob(["("+worker_function.toString()+")()"],{type:"text/javascript"})),g=URL.createObjectURL(new Blob([PDFBuilder.toString()],{type:"text/javascript"})),i=new Worker(n),o=(()=>{switch(parseInt(s)){case 1:return.8;case 2:return.65;case 3:return.5;default:return 1}})(),c={url:g,orientation:t,format:a,type:"start"};i.addEventListener("message",t=>{switch(t.data.type){case"finish":saveAs(t.data.data,`${r[0].getElementsByClassName("imageName")[0].innerText.substring(r[0].getElementsByClassName("imageName")[0].innerText.lastIndexOf("."),0)}.pdf`),e.remove();break;case"error":e.remove(),alert((()=>"이미지 PDF 변환"==document.title?"알수없는 오류!":"イメージを PDF に変換"==document.title?"不明なエラーです。":"Unknown error!")())}i.terminate(),URL.revokeObjectURL(n),URL.revokeObjectURL(g)}),i.postMessage(c);for(let e=0;e<r.length;e++){const t=r[e].getElementsByTagName("img")[0];""!=t.src?getImageSrc(t.src,s,o).then(n=>{const g={page:e,src:n,width:t.naturalWidth,height:t.naturalHeight,format:a,max:r.length,revoke:0!=s,type:"image"};i.postMessage(g)}):t.onload=(()=>{getImageSrc(t.src,s,o).then(n=>{const g={page:e,src:n,width:t.naturalWidth,height:t.naturalHeight,format:a,max:r.length,revoke:0!=s,type:"image"};i.postMessage(g)})})}}),saveAs=(e,t)=>{const a=document.createElement("a");a.target="_blank",a.href=e,a.download=t,a.click(),a.remove()};