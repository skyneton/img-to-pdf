const worker_function=()=>{let e;const t=new function(){let e=0;this.get=(()=>e),this.add=(()=>++e)};self.addEventListener("message",s=>{const r=s.data;switch(r.type){case"start":importScripts(r.url),e=a(r.orientation,r.util,r.format);break;case"image":for(;e.getNumberOfPages()<r.page;)e.addPage();((a,s,r,g,n,i,o=!1)=>{setTimeout(()=>{try{if(e.setPage(a),"auto"==n)e.setPageWidth(a,r),e.setPageHeight(a,g),e.addImage(s,"JPEG",0,0,r,g);else{const t=e.getPageWidth(a)/r>e.getPageHeight(a)/g?self.doc.getPageHeight(a)/g:self.doc.getPageWidth(a)/r,n=(e.getPageWidth(a)-r*t)/2,i=(e.getPageHeight(a)-g*t)/2;e.addImage(s,"JPEG",n,i,e.getPageWidth(a)-n,e.getPageHeight(a)-i)}}catch(e){console.log(e)}if(o&&URL.revokeObjectURL(s),t.add()>=i)try{self.postMessage({data:URL.createObjectURL(e.output("blob")),type:"finish"})}catch{self.postMessage({type:"error"})}})})(r.page,r.src,r.width,r.height,r.format,r.max,r.revoke)}});const a=(e,t,a)=>{return new jspdf.jsPDF({orientation:e,unit:t,format:(()=>"auto"==a?"a4":a)()})}},addImage=(e,t,a,s,r,g,n,i,o,c,m=!1)=>{setTimeout(()=>{if(e.setPage(t),"auto"==g)e.setPageWidth(t,s),e.setPageHeight(t,r),e.addImage(a,"JPEG",0,0,s,r);else{const g=e.getPageWidth(t)/s>e.getPageHeight(t)/r?e.getPageHeight(t)/r:e.getPageWidth(t)/s,n=(e.getPageWidth(t)-s*g)/2,i=(e.getPageHeight(t)-r*g)/2;e.addImage(a,"JPEG",n,i,e.getPageWidth(t)-n,e.getPageHeight(t)-i)}if(m&&URL.revokeObjectURL(a),i.add()>=o){const t=URL.createObjectURL(e.output("blob"));saveAs(t,n),URL.revokeObjectURL(t),c.remove()}})},PDFCreate=(e,t,a)=>{return new jspdf.jsPDF({orientation:e,unit:t,format:(()=>"auto"==a?"a4":a)()})},imageCompress=(e,t)=>new Promise(a=>{new Compressor(e,{quality:t,success(e){a(URL.createObjectURL(e))}})}),getImageSrc=(e,t,a)=>new Promise(s=>{0==t?s(e):imageCompress(e,a).then(e=>{s(e)})}),imageListPDF=(e,t,a,s,r,g,n)=>new Promise(()=>{const i=PDFCreate(t,a,s),o=`${g[0].getElementsByClassName("imageName")[0].innerText.substring(g[0].getElementsByClassName("imageName")[0].innerText.lastIndexOf("."),0)}.pdf`,c=(()=>{switch(parseInt(n)){case 1:return.8;case 2:return.65;case 3:return.5;default:return 1}})(),m=new function(){let e=0;this.get=(()=>e),this.add=(()=>++e)};compressTime=0;for(let t=0;t<g.length;t++){for(;i.getNumberOfPages()<t+1;)i.addPage();const a=g[t].getElementsByTagName("img")[0];getImageSrc(a.src,n,c).then(c=>{addImage(i,t+1,c,a.naturalWidth*r,a.naturalHeight*r,s,o,m,g.length,e,0!=n)})}}),imageListPDFByThread=(e,t,a,s,r,g,n)=>new Promise(()=>{const i=URL.createObjectURL(new Blob(["("+worker_function.toString()+")()"],{type:"text/javascript"})),o=URL.createObjectURL(new Blob(["("+jspdf_worker.toString()+")()"],{type:"text/javascript"})),c=new Worker(i),m=(()=>{switch(parseInt(n)){case 1:return.8;case 2:return.65;case 3:return.5;default:return 1}})(),d={url:o,orientation:t,util:a,format:s,type:"start"};c.addEventListener("message",t=>{switch(c.terminate(),URL.revokeObjectURL(i),URL.revokeObjectURL(o),t.data.type){case"finish":saveAs(t.data.data,`${g[0].getElementsByClassName("imageName")[0].innerText.substring(g[0].getElementsByClassName("imageName")[0].innerText.lastIndexOf("."),0)}.pdf`),e.remove();break;case"error":e.remove(),alert((()=>"이미지 PDF 변환"==document.title?"알수없는 오류!":"イメージを PDF に変換"==document.title?"不明なエラーです。":"Unknown error!")())}}),c.postMessage(d);for(let e=0;e<g.length;e++){const t=g[e].getElementsByTagName("img")[0];getImageSrc(t.src,n,m).then(a=>{const i={page:e+1,src:a,width:t.naturalWidth*r,height:t.naturalHeight*r,format:s,max:g.length,revoke:0!=n,type:"image"};c.postMessage(i)})}}),saveAs=(e,t)=>{const a=document.createElement("a");a.target="_blank",a.href=e,a.download=t,a.click(),a.remove()};