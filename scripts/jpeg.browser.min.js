function PDFBuilder(){"use strict";if(void 0===new.target)throw new Error("Constructor must be called with new.");let t,e,o,i=0,r=[],a=[],n=[],h=0,d=0,s=[];const c=()=>(n[++h-1]=d,h),g=t=>{A(`${t} 0 obj`)};this.addPage=(()=>{let e,o,a;if(arguments.length>1&&("number"==typeof arguments[0]?(e=arguments[0],o=arguments[1],a=arguments[2]):(e=arguments[0].orientation,o=arguments[0].format,a=arguments[0].rotate)),i=r.length,void 0===e&&void 0===o&&void 0===a)r[i]={media:{width:t.width,height:t.height,format:t.format,rotate:t.rotate}};else{e=e||t.orientation,o=o||t.format,a=a||t.rotate;const n=l(e,o);r[i]={media:{width:n.width,height:n.height,format:n.format,rotate:a}}}}),this.setPageWidth=function(){if(0==arguments.length)throw new Error("너비를 입력해주세요.");let t,e;if(arguments.length>=2?(t=arguments[0],e=arguments[1]):e=arguments[0],t|=i,isNaN(t)||isNaN(e))throw new Error("숫자 형태로 입력해주세요.");r[t].media.width=e},this.setPageHeight=function(){if(0==arguments.length)throw new Error("너비를 입력해주세요.");let t,e;if(arguments.length>=2?(t=arguments[0],e=arguments[1]):e=arguments[0],t|=i,isNaN(t)||isNaN(e))throw new Error("숫자 형태로 입력해주세요.");r[t].media.height=e},this.getPageWidth=function(){let t=arguments[0];if(void 0===t&&(t=i),isNaN(t))throw new Error("숫자를 입력해주세요.");if(t<0||Math.floor(t)!=t)throw new Error("0 이상의 정수여야 합니다.");return r[t].media.width},this.getPageHeight=function(){let t=arguments[0];if(void 0===t&&(t=i),isNaN(t))throw new Error("숫자를 입력해주세요.");if(t<0||Math.floor(t)!=t)throw new Error("0 이상의 정수여야 합니다.");return r[t].media.height},this.removePage=(t=>{r=r.splice(t,1)}),this.setPage=(t=>{i=t}),this.getNumberOfPages=(()=>r.length),this.getNowPage=(()=>i);const l=(t,e)=>{const o={a0:[2384,3370],a1:[1684,2384],a2:[1191,1684],a3:[842,1191],a4:[595,842],a5:[420,595],a6:[298,420],a7:[210,298],a8:[147,210],a9:[105,147],a10:[74,105],b0:[2835,4008],b1:[2004,2835],b2:[1417,2004],b3:[1001,1417],b4:[709,1001],b5:[499,709],b6:[354,499],b7:[249,354],b8:[176,249],b9:[125,176],b10:[88,125],c0:[2599,3677],c1:[1837,2599],c2:[1298,1837],c3:[918,1298],c4:[649,918],c5:[459,649],c6:[323,459],c7:[230,323],c8:[162,230],c9:[113,162],c10:[79,113],dl:[312,624],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};let i,r;if("auto"==(e=(e||"auto").toLowerCase())?e="auto":o[e.toLowerCase()]?(r=o[e.toLowerCase()][0],i=o[e.toLowerCase()][1]):(r=(e="custom")[0],i=e[1]),("l"==(t=(t||"p").toLowerCase())||"landscape"==t)&&i>r){const t=r;r=i,i=t}else if(("p"==t||"portrait"==t)&&r>i){const t=r;r=i,i=t}return{width:r,height:i,format:e,orientation:t}};this.toBlob=function(){p(),v(),C(),f(),u();const t=d;w(),m(),A("startxref"),A(`${t}`),A("%%EOF");let e=0;for(let t=0;t<a.length;t++)e+=a[t].length+1;e--;const o=new ArrayBuffer(e),i=new Uint8Array(o);let r=0;for(let t=0;t<a.length;t++){const e=a[t];for(let t=0;t<e.length;t++)i[r++]=e.charCodeAt(t);i[r++]=10}return new Blob([o],{type:"appliocation/pdf"})};const f=()=>{const t=[];if(Object.keys(s).length>0)for(const e in s){const o=s[e],i=c();g(i),A("<<"),A("/Type /XObject"),A("/Subtype /Image"),A(`/Width ${o.width}`),A(`/Height ${o.height}`),A(`/BitsPerComponent ${o.bitsPerComponent}`),A(`/ColorSpace /${o.colorSpace}`),A("/Filter /DCTDecode"),A(`/Length ${o.data.length}`),A(">>"),A("stream"),A(o.data),A("endstream"),A("endobj"),t.push(i)}g(o),A("<<"),A("/XObject <<");for(let e=0;e<t.length;e++)A(`/I${e} ${t[e]} 0 R`);A(">>"),A(">>"),A("endobj")},m=()=>{A("trailer"),A("<<"),A(`/Size ${h+1}`),A(`/Root ${h} 0 R`);let t="00000000000000000000000000000000";t=t.split("").map(()=>"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))).join(""),A(`/ID [<${t}><${t}>]`),A(">>")},w=()=>{A("xref"),A(`0 ${h+1}`),A("0000000000 65535 f");for(let t=0;t<h;t++){const e=n[t];A(`${("0000000000"+e).slice(-10)} 00000 n`)}},u=()=>{const t=e;g(c()),A("<<"),A("/Type /Catalog"),A(`/Pages ${t} 0 R`),A(">>"),A("endobj")},C=()=>{let t="/Kids [ ";for(let e=0;e<r.length;e++)t+=b(r[e],c(),o,c())+" 0 R ";g(e),A("<<"),A("/Type /Pages"),A(t+"]"),A(`/Count ${r.length}`),A(">>"),A("endobj")},b=(t,o,i,r)=>{if(g(o),A("<<"),A("/Type /Page"),A(`/Parent ${e} 0 R`),void 0!==t.image&&A(`/Resources ${i} 0 R`),"auto"!=t.media.format)A(`/MediaBox [0 0 ${t.media.width} ${t.media.height}]`);else if(t.image){let e=t.image[0].width,o=t.image[0].height;for(let i=1;i<t.image.length;i++)t.image[i].width>e&&(e=t.image[i].width),t.image[i].height>o&&(o=t.image[i].height);A(`/MediaBox [ 0 0 ${e} ${o} ]`)}if(t.rotate&&A(`/Rotate ${t.media.rotate}`),A(`/Contents ${r} 0 R`),A(">>"),A("endobj"),g(r),t.image){A("<<");let e="";for(let o=0;o<t.image.length;o++)0!=o&&(e+="\n"),e+="q",e+="\n"+[t.image[o].width,"0","0",t.image[o].height,t.image[o].x,t.image[o].y,"cm"].join(" "),e+=`\n/I${T(t.image[o].hash)} Do`,e+="\nQ";A(`/Length ${e.length}`),A(">>"),A("stream"),A(e),A("endstream")}return A("endobj"),o},p=()=>{h=0,a=[],d=0,n=[],e=c(),o=c()},v=()=>{A("%PDF-1.4"),A("%ºß¬à")},A=function(){if(0==arguments.length)throw new Error("작성 오류");const t=1==arguments.length?arguments[0]:arguments.join(" ");d+=t.length+1,a.push(t)};this.drawImage=function(){let t,e,o,r,a=arguments[0];if(void 0===a)throw new Error("이미지를 입력해주세요.");if(t=arguments[1]||"0",e=arguments[2]||"0",o=arguments[3],r=arguments[4],"object"==typeof a&&"src"in a&&(o=o||a.naturalWidth,r=r||a.naturalHeight,a=a.src),isNaN(t)||isNaN(e))throw new Error("x, y는 숫자 형태여야 합니다.");return void 0!==t&&(t=k(t,5)),void 0!==e&&(e=k(e,5)),void 0!==o&&(o=k(o,5)),void 0!==r&&(r=k(r,5)),$(i,a,t,e,o,r)};const $=(t,e,o,i,a,n)=>new Promise(h=>{D(e).then(e=>{const d=I(e);if(this.isImageNotSupported(d))throw new Error(`${d} 형식은 지원하지 않는 이미지입니다.`);const c=W(e).toString();if(null!=s[c])return s[c].connection++,null==r[t].image&&(r[t].image=[]),r[t].image.push({hash:c,width:a||s[c].width,height:n||s[c].height,x:o,y:i}),void h("drawing finish");y(t,e,o,i,a,n,c,d),h("drawing finish")})}),y=(t,e,o,i,a,n,h,d)=>{const c=N(e,d);"data"in c&&(e=c.data);const g=x(c.numComponents);if(void 0===g)throw new Error("Color Space를 가져오는데 실패하였습니다.");s[h]={data:e,width:c.width,height:c.height,colorSpace:g,bitsPerComponent:8,connection:1},null==r[t].image&&(r[t].image=[]),r[t].image.push({hash:h,x:o,y:i,width:a||c.width,height:n||c.height})},P=[192,193,194,195,196,197,198,199],N=(t,e)=>{switch(e){case"JPEG":return E(t)}},E=t=>{let e,o,i,r=256*t.charCodeAt(4)+t.charCodeAt(5);for(let a=4;a<t.length;a+=2){if(a+=r,-1!=P.indexOf(t.charCodeAt(a+1)))return o=256*t.charCodeAt(a+5)+t.charCodeAt(a+6),e=256*t.charCodeAt(a+7)+t.charCodeAt(a+8),i=t.charCodeAt(a+9),t.length>a+420&&(1==o&&o<256*t.charCodeAt(a+425)+t.charCodeAt(a+426)&&(o=256*t.charCodeAt(a+425)+t.charCodeAt(a+426),t.length>a+427&&(e=256*t.charCodeAt(a+427)+t.charCodeAt(a+428))),1==i&&t.length>a+429&&(1==t.charCodeAt(a+429)||3==t.charCodeAt(a+429)||4==t.charCodeAt(a+429))&&(i=t.charCodeAt(a+429))),{width:e,height:o,numComponents:i};r=256*t.charCodeAt(a+2)+t.charCodeAt(a+3)}};this.isImageNotSupported=(t=>!L()[t]);const j="DeviceRGB",B="DeviceGray",R="DeviceCMYK",x=t=>{let e;switch(t){case 1:e=B;break;case 3:e=j;break;case 4:e=R}return e},D=async t=>G(t)?t.split(",")[1]:("object"==typeof t&&"src"in t&&(t=t.src),O(t)&&(t=await fetch(t).then(t=>t.blob())),(M(t)||S(t))&&(t=await t.arrayBuffer(),t=new Uint8Array(t)),t instanceof Uint8Array?F(t):void 0),F=t=>{let e="";const o=t.byteLength||t.length;for(let i=0;i<o;i++)e+=String.fromCharCode(t[i]);return e},I=t=>{const e=L();for(const o in e){const i=e[o];for(let e=0;e<i.length;e++){let r=!0;for(let o=0;o<i[e].length;o++)if(void 0!==i[e][o]&&i[e][o]!==t.charCodeAt(o)){r=!1;break}if(r)return o}}return"UNKNOWN"},S=t=>t instanceof File,M=t=>t instanceof Blob,O=t=>"string"==typeof t&&t.startsWith("blob:"),G=t=>"string"==typeof t&&t.startsWith("data:image"),L=()=>({PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]}),W=t=>{let e=0;for(let o=0;o<t.length;o++)e=(e<<5)-e+t.charCodeAt(o),e|=0;return e},T=t=>Object.keys(s).indexOf(t),k=(t,e)=>Math.round(t*10**e)/10**e;(()=>{let e,o,i;arguments.length>=1&&("number"==typeof arguments[0]?(e=arguments[0],o=arguments[1],i=arguments[2]):(e=arguments[0].orientation,o=arguments[0].format,i=arguments[0].rotate));const a=l(e,o);t={orientation:a.orientation,width:a.width,height:a.height,format:a.format,rotate:i},r[0]={media:{width:a.width,height:a.height,format:a.format,rotate:i}}})()}