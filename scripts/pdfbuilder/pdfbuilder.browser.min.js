function PDFBuilder(){"use strict";if(void 0===new.target)throw new Error("Constructor must be called with new.");let t,e,o,r=0,i=[],a=[],n=[],h=0,d=0,g=[];const l=()=>(n[++h-1]=d,h),c=t=>{w(`${t} 0 obj`)},s=(t,e)=>{const o={a0:[2384,3370],a1:[1684,2384],a2:[1191,1684],a3:[842,1191],a4:[595,842],a5:[420,595],a6:[298,420],a7:[210,298],a8:[147,210],a9:[105,147],a10:[74,105],b0:[2835,4008],b1:[2004,2835],b2:[1417,2004],b3:[1001,1417],b4:[709,1001],b5:[499,709],b6:[354,499],b7:[249,354],b8:[176,249],b9:[125,176],b10:[88,125],c0:[2599,3677],c1:[1837,2599],c2:[1298,1837],c3:[918,1298],c4:[649,918],c5:[459,649],c6:[323,459],c7:[230,323],c8:[162,230],c9:[113,162],c10:[79,113],dl:[312,624],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};let r,i;if("auto"==(e=(e||"auto").toLowerCase())?e="auto":o[e.toLowerCase()]?(i=o[e.toLowerCase()][0],r=o[e.toLowerCase()][1]):(i=(e="custom")[0],r=e[1]),("l"==(t=(t||"p").toLowerCase())||"landscape"==t)&&r>i){const t=i;i=r,r=t}else if(("p"==t||"portrait"==t)&&i>r){const t=i;i=r,r=t}return{width:i,height:r,format:e,orientation:t}},f=(t,o,r,i)=>{if(c(o),m("<<"),w("/Type /Page"),w(`/Parent ${e} 0 R`),void 0!==t.image&&w(`/Resources ${r} 0 R`),"auto"!=t.media.format)w(`/MediaBox [0 0 ${t.media.width} ${t.media.height}]`);else if(t.image){let e=t.image[0].width,o=t.image[0].height;for(let r=1;r<t.image.length;r++)t.image[r].width>e&&(e=t.image[r].width),t.image[r].height>o&&(o=t.image[r].height);w(`/MediaBox [ 0 0 ${e} ${o} ]`)}if(t.rotate&&w(`/Rotate ${t.media.rotate}`),w(`/Contents ${i} 0 R`),w(">>"),m("endobj"),c(i),t.image){m("<<");let e="";for(let o=0;o<t.image.length;o++)0!=o&&(e+="\n"),e+="q",e+="\n"+[t.image[o].width,"0","0",t.image[o].height,t.image[o].x,t.image[o].y,"cm"].join(" "),e+=`\n/I${I(t.image[o].hash)} Do`,e+="\nQ";w(`/Length ${e.length}`),w(">>"),w("stream"),w(e),w("endstream")}return w("endobj"),o},m=function(){if(0==arguments.length)throw new Error("작성 오류");const t=1==arguments.length?arguments[0]:arguments.join(" ");d+=t.length+1,a[a.length-1]+=t},w=function(){if(0==arguments.length)throw new Error("작성 오류");const t=1==arguments.length?arguments[0]:arguments.join(" ");d+=t.length+1,a.push(t)},u=(t,e,o,r,a,n,h,d)=>{const l=b(e,d);"data"in l&&(e=l.data);const c=y(l.numComponents);if(void 0===c)throw new Error("Color Space를 가져오는데 실패하였습니다.");g[h]={data:e,width:l.width,height:l.height,colorSpace:c,bitsPerComponent:8,connection:1},null==i[t].image&&(i[t].image=[]),i[t].image.push({hash:h,x:o,y:r,width:a||l.width,height:n||l.height})},C=[192,193,194,195,196,197,198,199],b=(t,e)=>{switch(e){case"JPEG":return p(t)}},p=t=>{let e,o,r,i=256*t.charCodeAt(4)+t.charCodeAt(5);for(let a=4;a<t.length;a+=2){if(a+=i,-1!=C.indexOf(t.charCodeAt(a+1)))return o=256*t.charCodeAt(a+5)+t.charCodeAt(a+6),e=256*t.charCodeAt(a+7)+t.charCodeAt(a+8),r=t.charCodeAt(a+9),t.length>a+420&&(1==o&&o<256*t.charCodeAt(a+425)+t.charCodeAt(a+426)&&(o=256*t.charCodeAt(a+425)+t.charCodeAt(a+426),t.length>a+427&&(e=256*t.charCodeAt(a+427)+t.charCodeAt(a+428))),1==r&&t.length>a+429&&(1==t.charCodeAt(a+429)||3==t.charCodeAt(a+429)||4==t.charCodeAt(a+429))&&(r=t.charCodeAt(a+429))),{width:e,height:o,numComponents:r};i=256*t.charCodeAt(a+2)+t.charCodeAt(a+3)}},v="DeviceRGB",A="DeviceGray",$="DeviceCMYK",y=t=>{let e;switch(t){case 1:e=A;break;case 3:e=v;break;case 4:e=$}return e},P=async t=>x(t)?t.split(",")[1]:("object"==typeof t&&"src"in t&&(t=t.src),R(t)&&(t=await fetch(t).then(t=>t.blob())),(B(t)||j(t))&&(t=await t.arrayBuffer(),t=new Uint8Array(t)),t instanceof Uint8Array?N(t):void 0),N=t=>{let e="";const o=t.byteLength||t.length;for(let r=0;r<o;r++)e+=String.fromCharCode(t[r]);return e},E=t=>{const e=D();for(const o in e){const r=e[o];for(let e=0;e<r.length;e++){let i=!0;for(let o=0;o<r[e].length;o++)if(void 0!==r[e][o]&&r[e][o]!==t.charCodeAt(o)){i=!1;break}if(i)return o}}return"UNKNOWN"},j=t=>t instanceof File,B=t=>t instanceof Blob,R=t=>"string"==typeof t&&t.startsWith("blob:"),x=t=>"string"==typeof t&&t.startsWith("data:image"),D=()=>({PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,224,void 0,void 0,74,70,88,88,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]}),F=t=>{let e=0;for(let o=0;o<t.length;o++)e=(e<<5)-e+t.charCodeAt(o),e|=0;return e},I=t=>Object.keys(g).indexOf(t),S=(t,e)=>Math.round(t*10**e)/10**e;(()=>{let e,o,r;arguments.length>=1&&("number"==typeof arguments[0]?(e=arguments[0],o=arguments[1],r=arguments[2]):(e=arguments[0].orientation,o=arguments[0].format,r=arguments[0].rotate));const a=s(e,o);t={orientation:a.orientation,width:a.width,height:a.height,format:a.format,rotate:r},i[0]={media:{width:a.width,height:a.height,format:a.format,rotate:r}}})();var M=new class{addPage(){let e,o,a;if(arguments.length>1&&("number"==typeof arguments[0]?(e=arguments[0],o=arguments[1],a=arguments[2]):(e=arguments[0].orientation,o=arguments[0].format,a=arguments[0].rotate)),r=i.length,void 0===e&&void 0===o&&void 0===a)i[r]={media:{width:t.width,height:t.height,format:t.format,rotate:t.rotate}};else{e=e||t.orientation,o=o||t.format,a=a||t.rotate;const n=s(e,o);i[r]={media:{width:n.width,height:n.height,format:n.format,rotate:a}}}}setPageWidth(){if(0==arguments.length)throw new Error("너비를 입력해주세요.");let t,e;if(arguments.length>=2?(t=arguments[0],e=arguments[1]):e=arguments[0],t|=r,isNaN(t)||isNaN(e))throw new Error("숫자 형태로 입력해주세요.");i[t].media.width=e}setPageHeight(){if(0==arguments.length)throw new Error("너비를 입력해주세요.");let t,e;if(arguments.length>=2?(t=arguments[0],e=arguments[1]):e=arguments[0],t|=r,isNaN(t)||isNaN(e))throw new Error("숫자 형태로 입력해주세요.");i[t].media.height=e}getPageWidth(){let t=arguments[0];if(void 0===t&&(t=r),isNaN(t))throw new Error("숫자를 입력해주세요.");if(t<0||Math.floor(t)!=t)throw new Error("0 이상의 정수여야 합니다.");return i[t].media.width}getPageHeight(){let t=arguments[0];if(void 0===t&&(t=r),isNaN(t))throw new Error("숫자를 입력해주세요.");if(t<0||Math.floor(t)!=t)throw new Error("0 이상의 정수여야 합니다.");return i[t].media.height}removePage(t){i=i.splice(t,1)}setPage(t){r=t}get numPages(){return i.length}get currentPage(){return r}toBlob(){h=0,a=[],d=0,n=[],e=l(),o=l(),w("%PDF-1.4"),(()=>{let t="/Kids [ ";for(let e=0;e<i.length;e++)t+=f(i[e],l(),o,l())+" 0 R ";c(e),m("<<"),w("/Type /Pages"),w(t+"]"),w(`/Count ${i.length}`),w(">>"),m("endobj")})(),(()=>{const t=[];if(Object.keys(g).length>0)for(const e in g){const o=g[e],r=l();c(r),m("<<"),w("/Type /XObject"),w("/Subtype /Image"),w(`/Width ${o.width}`),w(`/Height ${o.height}`),w(`/BitsPerComponent ${o.bitsPerComponent}`),w(`/ColorSpace /${o.colorSpace}`),w("/Filter /DCTDecode"),w(`/Length ${o.data.length}`),w(">>"),w("stream"),w(o.data),w("endstream"),w("endobj"),t.push(r)}c(o),m("<<"),w("/XObject <<");for(let e=0;e<t.length;e++)w(`/I${e} ${t[e]} 0 R`);w(">>"),m(">>"),m("endobj")})(),(()=>{const t=e;c(l()),m("<<"),w("/Type /Catalog"),w(`/Pages ${t} 0 R`),w(">>"),m("endobj")})();const t=d;(()=>{w("xref"),w(`0 ${h+1}`),w("0000000000 65535 f");for(let t=0;t<h;t++){const e=n[t];w(`${("0000000000"+e).slice(-10)} 00000 n`)}})(),(()=>{w("trailer"),m("<<"),w(`/Size ${h+1}`),w(`/Root ${h} 0 R`);let t="00000000000000000000000000000000";t=t.split("").map(()=>"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))).join(""),w(`/ID [<${t}><${t}>]`),w(">>")})(),w("startxref"),w(`${t}`),w("%%EOF");let r=0;for(let t=0;t<a.length;t++)r+=a[t].length+1;r--;const s=new ArrayBuffer(r),u=new Uint8Array(s);let C=0;for(let t=0;t<a.length;t++){const e=a[t];for(let t=0;t<e.length;t++)u[C++]=e.charCodeAt(t);u[C++]=10}return new Blob([s],{type:"appliocation/pdf"})}drawImage(){let t,e,o,a,n=arguments[0];if(void 0===n)throw new Error("이미지를 입력해주세요.");if(t=arguments[1]||"0",e=arguments[2]||"0",o=arguments[3],a=arguments[4],"object"==typeof n&&"src"in n&&(o=o||n.naturalWidth,a=a||n.naturalHeight,n=n.src),isNaN(t)||isNaN(e))throw new Error("x, y는 숫자 형태여야 합니다.");return void 0!==t&&(t=S(t,5)),void 0!==e&&(e=S(e,5)),void 0!==o&&(o=S(o,5)),void 0!==a&&(a=S(a,5)),((t,e,o,r,a,n)=>new Promise((h,d)=>{P(e).then(e=>{const l=E(e);M.isImageNotSupported(l)&&d(new Error(`${l} 형식은 지원하지 않는 이미지입니다.`));const c=F(e).toString();if(null!=g[c])return g[c].connection++,null==i[t].image&&(i[t].image=[]),i[t].image.push({hash:c,width:a||g[c].width,height:n||g[c].height,x:o,y:r}),void h("drawing finish");u(t,e,o,r,a,n,c,l),h("drawing finish")})}))(r,n,t,e,o,a)}isImageNotSupported(t){return!D()[t]}};return M}